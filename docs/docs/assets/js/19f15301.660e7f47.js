"use strict";(self.webpackChunkmodlib_docs=self.webpackChunkmodlib_docs||[]).push([[211],{8943:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>l,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"apps/matcher","title":"Matcher","description":"MatcherSettings","source":"@site/docs-api/apps/matcher.md","sourceDirName":"apps","slug":"/apps/matcher","permalink":"/docs/api-reference/apps/matcher","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1732028012000,"sidebarPosition":3,"frontMatter":{"title":"Matcher","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Heatmap","permalink":"/docs/api-reference/apps/heatmap"},"next":{"title":"Object Counter","permalink":"/docs/api-reference/apps/object_counter"}}');var i=n(4848),a=n(8453);const l={title:"Matcher",sidebar_position:3},r=void 0,c={},d=[{value:"MatcherSettings",id:"matchersettings",level:2},{value:"FIFOQueue",id:"fifoqueue",level:2},{value:"Methods",id:"methods",level:3},{value:'<span class="signature-title">__init__</span>',id:"__init__",level:4},{value:'<span class="signature-title">push</span>',id:"push",level:4},{value:'<span class="signature-title">pop</span>',id:"pop",level:4},{value:'<span class="signature-title">get_average</span>',id:"get_average",level:4},{value:"DetectedObject",id:"detectedobject",level:2},{value:"Methods",id:"methods-1",level:3},{value:'<span class="signature-title">__init__</span>',id:"__init__-1",level:4},{value:'<span class="signature-title">update</span>',id:"update",level:4},{value:'<span class="signature-title">missing</span>',id:"missing",level:4},{value:'<span class="signature-title">get</span>',id:"get",level:4},{value:'<span class="signature-title">__eq__</span>',id:"__eq__",level:4},{value:'<span class="signature-title">is_new</span>',id:"is_new",level:4},{value:'<span class="signature-title">__str__</span>',id:"__str__",level:4},{value:"Matcher",id:"matcher",level:2},{value:"Methods",id:"methods-2",level:3},{value:'<span class="signature-title">__init__</span>',id:"__init__-2",level:4},{value:'<span class="signature-title">match</span>',id:"match",level:4},{value:'<span class="signature-title">update_tracked</span>',id:"update_tracked",level:4},{value:'<span class="signature-title">get_mask</span>',id:"get_mask",level:4},{value:'<span class="signature-title">merge_tensors</span>',id:"merge_tensors",level:4},{value:'<span class="signature-title">__len__</span>',id:"__len__",level:4},{value:'<span class="signature-title">__iter__</span>',id:"__iter__",level:4},{value:"OverlapDetector",id:"overlapdetector",level:2},{value:"Methods",id:"methods-3",level:3},{value:'<span class="signature-title">__init__</span>',id:"__init__-3",level:4},{value:'<span class="signature-title">filter</span>',id:"filter",level:4},{value:'<span class="signature-title">bbox_intersect_ratio</span>',id:"bbox_intersect_ratio",level:4},{value:'<span class="signature-title">__len__</span>',id:"__len__-1",level:4},{value:'<span class="signature-title">__iter__</span>',id:"__iter__-1",level:4}];function h(e){const s={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"module-separator","data-content":"Dataclass"}),"\n",(0,i.jsx)(s.h2,{id:"matchersettings",children:"MatcherSettings"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)("div",{className:"signature",children:(0,i.jsx)("b",{children:"MatcherSettings"})}),"\nHelper datacalss containing the matcher settings."]}),"\n",(0,i.jsx)("div",{}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)("span",{className:"signature-title",children:"MAX_MISSING_OVERLAP: int"}),"\xa0\xa0\xa0\xa0"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)("span",{className:"signature-title",children:"MAX_MISSING_TRACKER: int"}),"\xa0\xa0\xa0\xa0"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)("span",{className:"signature-title",children:"MIN_OVERLAP_THRESHOLD: float"}),"\xa0\xa0\xa0\xa0"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)("span",{className:"signature-title",children:"HYSTERESIS: float"}),"\xa0\xa0\xa0\xa0"]}),"\n"]}),"\n",(0,i.jsx)("div",{className:"module-separator","data-content":"Class"}),"\n",(0,i.jsx)(s.h2,{id:"fifoqueue",children:"FIFOQueue"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"FIFOQueue("}),"n, initial_bbox",(0,i.jsx)("b",{children:")"})]}),"\nThe FIFOQueue class provides positional filtering, enabling smoother tracking of objects."]}),"\n",(0,i.jsx)(s.h3,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(s.h4,{id:"__init__",children:(0,i.jsx)("span",{className:"signature-title",children:"__init__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__init__("}),"self, n, initial_bbox",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Initialize self.  See help(type(self)) for accurate signature."}),"\n",(0,i.jsx)(s.h4,{id:"push",children:(0,i.jsx)("span",{className:"signature-title",children:"push"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"push("}),"self, item",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"pop",children:(0,i.jsx)("span",{className:"signature-title",children:"pop"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"pop("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"get_average",children:(0,i.jsx)("span",{className:"signature-title",children:"get_average"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"get_average("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)("div",{className:"module-separator","data-content":"Class"}),"\n",(0,i.jsx)(s.h2,{id:"detectedobject",children:"DetectedObject"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"DetectedObject("}),"bbox:\xa0numpy.ndarray, confidence:\xa0float, class_id:\xa0int, tracker_id:\xa0float, overlap:\xa0float, settings:\xa0",(0,i.jsx)(s.a,{href:"/api-reference/apps/matcher#matchersettings",children:"MatcherSettings"}),(0,i.jsx)("b",{children:")"})]}),"\nA class encapsulates the state information of each detected object,\nmaintaining details such as position, state of overlap, and other relevant attributes."]}),"\n",(0,i.jsx)(s.h3,{id:"methods-1",children:"Methods"}),"\n",(0,i.jsx)(s.h4,{id:"__init__-1",children:(0,i.jsx)("span",{className:"signature-title",children:"__init__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__init__("}),"self, bbox:\xa0numpy.ndarray, confidence:\xa0float, class_id:\xa0int, tracker_id:\xa0float, overlap:\xa0float, settings:\xa0",(0,i.jsx)(s.a,{href:"/api-reference/apps/matcher#matchersettings",children:"MatcherSettings"}),(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Args:"}),(0,i.jsx)(s.br,{}),"\n","box: array of base object bbox"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"confidence"})," (float): confidence value of base object detection"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"class_id"})," (int): id value of the base detection"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"tracker_id"})," (float): tracker id result if being used. Will use a default number if not in use"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"overlap"})," (float): overlap_ratio of the objects being matched"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"update",children:(0,i.jsx)("span",{className:"signature-title",children:"update"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"update("}),"self, source:\xa0",(0,i.jsx)(s.a,{href:"/api-reference/apps/matcher#detectedobject",children:"DetectedObject"}),(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Update the values of object depending on changes to the objects being matched"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"source"})," (",(0,i.jsx)(s.a,{href:"/api-reference/apps/matcher#detectedobject",children:"DetectedObject"}),"): Class with updated values"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"missing",children:(0,i.jsx)("span",{className:"signature-title",children:"missing"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"missing("}),"self",(0,i.jsx)("b",{children:")"})," \u2011> bool"]}),"\n",(0,i.jsx)(s.p,{children:"Increases the missing counter if object hasn't been detected in MAX_MISSING_TRACKER"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns:"})," (bool)",(0,i.jsx)(s.br,{}),"\n","A bool value if counter is more than MAX_MISSING_TRACKER"]}),"\n",(0,i.jsx)(s.h4,{id:"get",children:(0,i.jsx)("span",{className:"signature-title",children:"get"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"get("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"__eq__",children:(0,i.jsx)("span",{className:"signature-title",children:"__eq__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__eq__("}),"self, other",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Return self==value."}),"\n",(0,i.jsx)(s.h4,{id:"is_new",children:(0,i.jsx)("span",{className:"signature-title",children:"is_new"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"is_new("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"__str__",children:(0,i.jsx)("span",{className:"signature-title",children:"__str__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__str__("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Return str(self)."}),"\n",(0,i.jsx)("div",{className:"module-separator","data-content":"Class"}),"\n",(0,i.jsx)(s.h2,{id:"matcher",children:"Matcher"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"Matcher("}),"max_missing_overlap:\xa0int\xa0=\xa060, max_missing_tracker:\xa0int\xa0=\xa030, min_overlap_threshold:\xa0float\xa0=\xa00.5, hysteresis:\xa0float\xa0=\xa00.4",(0,i.jsx)("b",{children:")"})]}),"\nA class responsible for parsing new detections, matching them with the current state of objects,\nand ensuring that each object's state is updated accordingly. This class plays a crucial role in maintaining the\naccuracy and consistency of object tracking by synchronizing detected events with existing object data."]}),"\n",(0,i.jsx)(s.p,{children:"For example, to create and use Matcher it can be used like this. Can also be used with Tracker"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"from modlib.apps import Matcher\n\nmatcher = Matcher()\n...\npeople = detections[detections.class_id == 0]\nhats =  detections[detections.class_id == 1]\ndetections = people[matcher.match(people, hats)]\n"})}),"\n",(0,i.jsx)(s.h3,{id:"methods-2",children:"Methods"}),"\n",(0,i.jsx)(s.h4,{id:"__init__-2",children:(0,i.jsx)("span",{className:"signature-title",children:"__init__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__init__("}),"self, max_missing_overlap:\xa0int\xa0=\xa060, max_missing_tracker:\xa0int\xa0=\xa030, min_overlap_threshold:\xa0float\xa0=\xa00.5, hysteresis:\xa0float\xa0=\xa00.4",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"max_missing_overlap"})," (int\xa0=\xa060): Maximum number of frames an object can be missing before it is considered lost."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"max_missing_tracker"})," (int\xa0=\xa030): Maximum number of frames an object can be missing before it is removed from tracking."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"min_overlap_threshold"})," (float\xa0=\xa00.5): Minimum overlap ratio required to consider two bounding boxes as overlapping."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"hysteresis"})," (float\xa0=\xa00.4): The hysteresis value used to determine the state of overlap detection."]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"match",children:(0,i.jsx)("span",{className:"signature-title",children:"match"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"match("}),"self, base_object:\xa0",(0,i.jsx)(s.a,{href:"/api-reference/models/results#detections",children:"Detections"}),", *objects_to_match:\xa0",(0,i.jsx)(s.a,{href:"/api-reference/models/results#detections",children:"Detections"}),(0,i.jsx)("b",{children:")"})," \u2011> List[bool]"]}),"\n",(0,i.jsx)(s.p,{children:"Checks to see if one lot of bbox Detections overlap with a List of other objects"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"base_object"})," (",(0,i.jsx)(s.a,{href:"/api-reference/models/results#detections",children:"Detections"}),"): The base Detections that will be to match other objects.\nobjects_to_match: Variadic list of the Detections to be checked against the main object."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns:"})," (List[bool])",(0,i.jsx)(s.br,{}),"\n","The mask of base detections that have all matched overlap objects"]}),"\n",(0,i.jsx)(s.h4,{id:"update_tracked",children:(0,i.jsx)("span",{className:"signature-title",children:"update_tracked"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"update_tracked("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Updates the tracked Detection information over time. Also adds new tracked Detections and removes them."}),"\n",(0,i.jsx)(s.h4,{id:"get_mask",children:(0,i.jsx)("span",{className:"signature-title",children:"get_mask"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"get_mask("}),"self",(0,i.jsx)("b",{children:")"})," \u2011> List[bool]"]}),"\n",(0,i.jsx)(s.p,{children:"Generates output mask for object being matched"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns:"})," (List[bool])",(0,i.jsx)(s.br,{}),"\n","The mask of detections that are matched for chosen object."]}),"\n",(0,i.jsx)(s.h4,{id:"merge_tensors",children:(0,i.jsx)("span",{className:"signature-title",children:"merge_tensors"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"merge_tensors("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"__len__",children:(0,i.jsx)("span",{className:"signature-title",children:"__len__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__len__("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"__iter__",children:(0,i.jsx)("span",{className:"signature-title",children:"__iter__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__iter__("}),"self",(0,i.jsx)("b",{children:")"})," \u2011> Iterator[Tuple[numpy.ndarray,\xa0float,\xa0int,\xa0int,\xa0float,\xa0int]]"]}),"\n",(0,i.jsx)("div",{className:"module-separator","data-content":"Class"}),"\n",(0,i.jsx)(s.h2,{id:"overlapdetector",children:"OverlapDetector"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"OverlapDetector("}),(0,i.jsx)("b",{children:")"})]}),"\nThe OverlapDetector class is used to identify overlapping objects.\nThe objects to be detected for overlaps are specified during the construction of an OverlapDetector instance.\nThis class can be used in scenarios where detecting spatial intersections or overlaps between objects is required."]}),"\n",(0,i.jsx)(s.h3,{id:"methods-3",children:"Methods"}),"\n",(0,i.jsx)(s.h4,{id:"__init__-3",children:(0,i.jsx)("span",{className:"signature-title",children:"__init__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__init__("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.p,{children:"Initialize self.  See help(type(self)) for accurate signature."}),"\n",(0,i.jsx)(s.h4,{id:"filter",children:(0,i.jsx)("span",{className:"signature-title",children:"filter"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"filter("}),"self, base_bboxes:\xa0numpy.ndarray, overlay_bboxes:\xa0numpy.ndarray",(0,i.jsx)("b",{children:")"})," \u2011> None"]}),"\n",(0,i.jsx)(s.p,{children:"Filters out the detections, both overlay and base, by calculating the intersect ratio."}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Args:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"base_bboxes"})," (numpy.ndarray): bboxes of a class_id that are being matched with all other objects"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"overlay_bboxes"})," (numpy.ndarray): bboxes of a class_id that are to be mathced with the base_bboxes"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:"bbox_intersect_ratio",children:(0,i.jsx)("span",{className:"signature-title",children:"bbox_intersect_ratio"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"bbox_intersect_ratio("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Returns:"}),(0,i.jsx)(s.br,{}),"\n","The overlap ratio between the base bounding box and the overlaying bounding box."]}),"\n",(0,i.jsx)(s.h4,{id:"__len__-1",children:(0,i.jsx)("span",{className:"signature-title",children:"__len__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__len__("}),"self",(0,i.jsx)("b",{children:")"})]}),"\n",(0,i.jsx)(s.h4,{id:"__iter__-1",children:(0,i.jsx)("span",{className:"signature-title",children:"__iter__"})}),"\n",(0,i.jsxs)("div",{className:"signature",children:[(0,i.jsx)("b",{children:"__iter__("}),"self",(0,i.jsx)("b",{children:")"})," \u2011> Iterator[Tuple[numpy.ndarray,\xa0float,\xa0int,\xa0int,\xa0float]]"]})]})}function o(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>r});var t=n(6540);const i={},a=t.createContext(i);function l(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);